<section style="direction: rtl; text-align: justify; margin: 30px;">

### مقدمه پروژه

این پروژه با هدف توسعه یک ابزار گزارش‌دهی خودکار طراحی شده است که به کاربران اجازه می‌دهد داده‌های پایگاه داده SQL Server را بازیابی، تحلیل و ذخیره کنند. این ابزار با استفاده از کوئری‌های SQL دلخواه به استخراج داده‌ها از پایگاه داده پرداخته و امکان ذخیره‌سازی نتایج به صورت گزارش‌های ساختاریافته در قالب‌های Excel و CSV را فراهم می‌آورد. این قابلیت‌ها برای محیط‌های داده‌محور که مدیریت و گزارش‌دهی کارآمد اطلاعات اهمیت بسیاری دارد، ایده‌آل است.

از طریق این ابزار، کاربران می‌توانند به سادگی داده‌های مورد نیاز خود را از جداول پایگاه داده استخراج کرده، آن‌ها را تحلیل و مدیریت کنند و در قالب‌های مختلف ذخیره نمایند. علاوه بر این، ابزار امکان اضافه‌کردن فیلترهای پیشرفته برای داده‌ها، مدیریت خودکار نام فایل‌ها و همچنین کنترل حجم داده‌های خروجی را نیز داراست.

---

### عملکرد کلی پروژه

#### 1. **اتصال به پایگاه داده**
   ابزار از کتابخانه قدرتمند **SQLAlchemy** برای مدیریت اتصال به پایگاه داده SQL Server استفاده می‌کند. با استفاده از این کتابخانه، ابزار می‌تواند به راحتی به پایگاه‌های داده مختلف متصل شود، چه از طریق احراز هویت SQL Server و چه از طریق احراز هویت مبتنی بر Windows. اتصال ایمن و مدیریت خودکار خطاهای مربوط به اتصال، اطمینان حاصل می‌کند که ابزار به طور صحیح با پایگاه داده ارتباط برقرار می‌کند.

#### 2. **اجرای کوئری‌های SQL**
   پس از ایجاد اتصال، کاربران می‌توانند کوئری‌های SQL دلخواه خود را اجرا کنند. این کوئری‌ها ممکن است شامل فیلترهای پیشرفته، گروه‌بندی و مرتب‌سازی داده‌ها باشند. داده‌های بازیابی‌شده به‌صورت مستقیم به یک DataFrame از کتابخانه **Pandas** منتقل می‌شوند که امکان مدیریت ساده‌تر و بهینه‌تر نتایج را فراهم می‌کند.

#### 3. **نمایش داده‌ها**
   داده‌های بازیابی‌شده ابتدا به صورت جدولی در کنسول نمایش داده می‌شوند. کاربران می‌توانند تعداد ردیف‌های نمایش داده شده را مشخص کنند، یا از تنظیمات پیش‌فرض استفاده کنند که ۱۰ ردیف اول نمایش داده می‌شود. نمایش داده‌ها از طریق **کتابخانه Tabulate** انجام می‌گیرد که خوانایی و سازماندهی بهتری از داده‌ها را فراهم می‌کند.

#### 4. **ذخیره داده‌ها**
   داده‌ها می‌توانند به فرمت‌های مختلفی ذخیره شوند:
   - **فرمت Excel**: نتایج کوئری در یک شیت جدید در فایل Excel ذخیره می‌شود. نام شیت‌ها بر اساس تاریخ و زمان فعلی ایجاد می‌شوند تا از بازنویسی فایل‌های قبلی جلوگیری شود.
   - **فرمت CSV**: داده‌ها به صورت فایل CSV نیز قابل ذخیره هستند. هر فایل با نام منحصربه‌فردی بر اساس زمان فعلی ذخیره می‌شود تا گزارش‌ها به صورت مرتب در دسترس باشند.

#### 5. **افزودن گزارش‌های گرافیکی (اختیاری)**
   یکی از ویژگی‌های قابل توسعه در این پروژه، افزودن نمودارهای گرافیکی به خروجی‌ها است. با استفاده از کتابخانه‌های مانند **Matplotlib** یا **Seaborn**، می‌توان نتایج کوئری‌های SQL را به صورت نمودارهای میله‌ای، دایره‌ای یا خطی نمایش داد و این امکان را به کاربران داد که داده‌ها را به صورت بصری تحلیل کنند.

---

### کتابخانه‌ها و ماژول‌های استفاده شده

#### 1. **ماژول Pandas**:
   - بارگذاری و ذخیره نتایج کوئری‌ها به عنوان DataFrame.
   - ذخیره داده‌ها به فایل‌های Excel و CSV.

#### 2. **ماژول SQLAlchemy**:
   - مدیریت اتصال به SQL Server و اجرای کوئری‌های SQL.
   - مدیریت خطاهای مربوط به ارتباط و اجرای کوئری‌ها.

#### 3. **ماژول Openpyxl**:
   - ذخیره داده‌ها در فایل‌های Excel.
   - مدیریت شیت‌های مختلف در فایل‌های Excel.

#### 4. **ماژول Pathlib**:
   - مدیریت مسیرهای فایل و دایرکتوری به شیوه‌ای شیءگرا.
   - ایجاد دایرکتوری‌های مورد نیاز برای ذخیره فایل‌های خروجی.

#### 5. **ماژول Tabulate**:
   - نمایش داده‌ها به صورت جدولی در کنسول.
   - بهبود خوانایی و سازماندهی داده‌ها برای کاربر.

#### 6. **ماژول Matplotlib/Seaborn** (اختیاری):
   - افزودن نمودارهای گرافیکی به خروجی برای تحلیل بصری داده‌ها.

---

### ویژگی‌های کلیدی

1. **ذخیره‌سازی پویا**: ذخیره‌سازی داده‌های خروجی به فرمت‌های Excel و CSV به صورت پویا و بسته به نیاز کاربر انجام می‌شود.
2. **مدیریت نام فایل‌ها**: نام فایل‌های Excel و CSV به صورت خودکار بر اساس تاریخ و زمان ایجاد می‌شوند تا از تداخل گزارش‌ها جلوگیری شود.
3. **مدیریت خطا**: مکانیسم‌های مدیریت خطا برای کنترل مشکلاتی مانند عدم اتصال به پایگاه داده یا خطاهای مربوط به اجرای کوئری‌ها در پروژه پیاده‌سازی شده است.
4. **گزارش‌دهی چندشیتی در Excel**: امکان ذخیره‌سازی هر کوئری در یک شیت جدید در فایل Excel، بدون بازنویسی شیت‌های قبلی.
5. **نمایش گرافیکی نتایج (اختیاری)**: امکان تولید نمودارهای گرافیکی از داده‌های بازیابی شده.

---

### نتیجه‌گیری

این پروژه با استفاده از کتابخانه‌های پرکاربردی مانند Pandas، SQLAlchemy و Openpyxl، یک ابزار همه‌کاره و قابل توسعه برای استخراج، نمایش و ذخیره داده‌ها از پایگاه داده SQL Server ارائه می‌دهد. قابلیت ذخیره‌سازی نتایج به صورت Excel و CSV، مدیریت خطا و امکان اضافه کردن گزارش‌های گرافیکی، این ابزار را به یک راهکار قدرتمند و منعطف برای تحلیل و گزارش‌دهی داده‌ها تبدیل کرده است.

</section>

***
