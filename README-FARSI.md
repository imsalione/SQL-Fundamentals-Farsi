<section style="direction: rtl; text-align: justify; margin: 30px;">

### عملکرد کلی پروژه

#### 1. **اتصال به پایگاه داده**
   ابزار از کتابخانه قدرتمند **SQLAlchemy** برای مدیریت اتصال به پایگاه داده SQL Server استفاده می‌کند. اتصال می‌تواند با یا بدون نام کاربری و رمز عبور انجام شود و این امکان را فراهم می‌آورد که در محیط‌های مختلف احراز هویت (SQL یا Windows) استفاده شود.

#### 2. **اجرای کوئری‌های SQL**
   کاربران می‌توانند کوئری‌های SQL دلخواه خود را اجرا کنند. داده‌های بازیابی‌شده به‌صورت مستقیم به یک **DataFrame** از کتابخانه **Pandas** منتقل می‌شوند که امکان مدیریت ساده‌تر و بهینه‌تر نتایج را فراهم می‌کند. همچنین، ابزار تعداد رکوردهای بازیابی‌شده از هر کوئری را نمایش می‌دهد تا کاربر بداند چه مقدار داده بازگشت داده شده است.

#### 3. **نمایش داده‌ها**
   داده‌های بازیابی‌شده به‌صورت جدولی در کنسول نمایش داده می‌شوند. برای نمایش بهتر و خوانایی بیشتر، از **کتابخانه PrettyTable** استفاده می‌شود که جداول زیبا و مرتب‌شده را به‌خوبی ارائه می‌دهد. کاربران می‌توانند تعداد ردیف‌های نمایش داده شده را مشخص کنند، یا از تنظیمات پیش‌فرض استفاده کنند که ۱۰ ردیف اول نمایش داده می‌شود.

#### 4. **ذخیره داده‌ها**
   نتایج کوئری می‌توانند به دو فرمت **Excel** و **CSV** ذخیره شوند. داده‌ها به‌طور خودکار با نام‌های منحصربه‌فرد ذخیره شده تا از بازنویسی گزارش‌های قبلی جلوگیری شود.

---

### کتابخانه‌ها و ماژول‌های استفاده‌شده 

#### 1. **کتابخانه Pandas**:
   - بارگذاری و ذخیره نتایج کوئری‌ها به عنوان DataFrame.
   - ذخیره داده‌ها به فایل‌های Excel و CSV.

#### 2. **کتابخانه SQLAlchemy**:
   - مدیریت اتصال به SQL Server و اجرای کوئری‌های SQL.
   - مدیریت خطاهای مربوط به ارتباط و اجرای کوئری‌ها.

#### 3. **کتابخانه Openpyxl**:
   - ذخیره داده‌ها در فایل‌های Excel.
   - مدیریت شیت‌های مختلف در فایل‌های Excel.

#### 4. **کتابخانه Pathlib**:
   - مدیریت مسیرهای فایل و دایرکتوری به شیوه‌ای شیءگرا.
   - ایجاد دایرکتوری‌های مورد نیاز برای ذخیره فایل‌های خروجی.

#### 5. **کتابخانه PrettyTable**:
   - نمایش داده‌ها به صورت جدولی زیبا و مرتب در کنسول.
   - بهبود خوانایی داده‌ها برای کاربر.

---

### ویژگی‌های کلیدی

1. **ذخیره‌سازی پویا**: ذخیره‌سازی داده‌های خروجی به فرمت‌های Excel و CSV به صورت پویا و بسته به نیاز کاربر انجام می‌شود.
2. **مدیریت نام فایل‌ها**: نام فایل‌های Excel و CSV به صورت خودکار بر اساس تاریخ و زمان ایجاد می‌شوند.
3. **مدیریت خطا**: مکانیسم‌های مدیریت خطا برای کنترل مشکلات مربوط به اتصال و اجرای کوئری‌ها پیاده‌سازی شده است.
4. **گزارش‌دهی چندشیتی در Excel**: هر کوئری در یک شیت جدید در فایل Excel ذخیره می‌شود.
5. **نمایش گرافیکی نتایج (اختیاری)**: امکان تولید نمودارهای گرافیکی از داده‌ها وجود دارد.
6. **نمایش تعداد رکوردهای خروجی**: پس از اجرای هر کوئری، تعداد رکوردهای بازیابی شده به کاربر نمایش داده می‌شود.
   
---

### نتیجه‌گیری

این پروژه با استفاده از کتابخانه‌های پرکاربردی مانند Pandas، SQLAlchemy و Openpyxl، یک ابزار همه‌کاره و قابل توسعه برای استخراج، نمایش و ذخیره داده‌ها از پایگاه داده SQL Server ارائه می‌دهد. قابلیت ذخیره‌سازی نتایج به صورت Excel و CSV، مدیریت خطا و امکان اضافه کردن گزارش‌های گرافیکی، این ابزار را به یک راهکار قدرتمند و منعطف برای تحلیل و گزارش‌دهی داده‌ها تبدیل کرده است.



</section>

***
